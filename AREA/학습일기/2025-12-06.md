### `handleMethodArgumentNotValid` 메서드 재정의 이슈

```java
public record ExerciseRequest(
        @Size(
        max = Exercise.MAX_NAME_LENGTH,
        message = Exercise.MAX_NAME_LENGTH_MESSAGE)
        String name,
        ExerciseCategory category,
        String description,
        Map<String, Object> details,
        List<ExerciseTargetRequest> targets,
        Set<EffectType> effects
) {
}
```
validation을 활용하여 예외에 대한 메세지를 설정했으나 아래와 같은 응답으로 요청됨


![[Pasted image 20251206010453.png]]
사전에 설정한 `ErrorResponse` 형식으로 응답되지 않음
오버라이드가 적절히 사용되지 않았고 이에 대해 스프링에서 지원하는 기본 형식의 에러 응답이 출력


```java
public ResponseEntity<Object> handleMethodArgumentNotValid(  
        MethodArgumentNotValidException e,  
        HttpHeaders headers,  
        HttpStatus status,  
        WebRequest request) {  
    log.warn("handleMethodArgumentNotValid ", e);  
    ErrorCode errorCode = CommonErrorCode.INVALID_PARAMETER;  
    return handleExceptionInternal(e, errorCode);  
}
```
기존 핸들러

```java
@Override  
protected @Nullable ResponseEntity<Object> handleMethodArgumentNotValid(  
        MethodArgumentNotValidException ex,  
        HttpHeaders headers,  
        HttpStatusCode status,  
        WebRequest request) {  
    return super.handleMethodArgumentNotValid(ex, headers, status, request);  
}
```
Spring Boot 3 이후로는 `HttpStatus`가 아닌 `HttpStatusCode`로 변경됐기에 오버라이드가 적절하게 발생하지 않은 것이었다.,


```json
{
    "code": "INVALID_PARAMETER",
    "message": "Invalid parameter included",
    "errors": [
        {
            "field": "targets[1].targetRole",
            "message": "널이어서는 안됩니다"
        },
        {
            "field": "name",
            "message": "운동명은 최대 30자 까지 입력 가능합니다."
        }
    ]
}
```
무사히 잘 적용

```java
public record ExerciseRequest(
        @NotNull
        @Size(max = Exercise.MAX_NAME_LENGTH, message = Exercise.MAX_NAME_LENGTH_MESSAGE)
        String name,

        @NotNull
        ExerciseCategory category,

        @NotNull
        String description,

        @NotNull
        Map<String, Object> details,

        @NotNull
        @Valid
        List<ExerciseTargetRequest> targets,

        @NotNull
        Set<EffectType> effects
) {
}
```
또한 내부에 dto가 있는 구조라면 `@Valid`를 선언해야 함



# 운동에 대한 기록을 어떻게 담아낼 것인가